<!DOCTYPE html>
<html>
<head>
  <title>namespace - consumer</title>
  <%= csrf_meta_tags %>
  <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %>
  <%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>
  <script type="text/javascript" src="https://js.pay.jp/"></script>
  <script type="text/javascript">Payjp.setPublicKey('ENV["PAYJP_PUBLIC_KEY"]');</script>
  <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/drawer/3.1.0/css/drawer.min.css">
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/iScroll/5.1.3/iscroll.min.js"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/drawer/3.1.0/js/drawer.min.js"></script>
</head>
<body class="drawer drawer--left">
  <header role="banner">
    <% if consumer_signed_in? %>
    <nav class="navbar navbar-expand-lg navbar-light bg-light"style="background-color: #99FF66;margin-left: 50px;">
      <a class="navbar-brand">WAGURI</a>
      <a class="logo"></a>
      <div class="nav-list-item"><p>ようこそ、
           <%= current_consumer.last_name %>さん！</p>
      </div>
      <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#Navber" aria-controls="Navber" aria-expanded="false" aria-label="ナビゲーションの切替">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="Navber">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item active">
            <a class="nav-link"><%= link_to 'マイページ', consumers_consumer_path(current_consumer), class: "nav-link disabled" %>
            </a>
          </li>
          <li class="nav-item active">
            <a class="nav-link">
              <%= link_to '商品一覧',consumers_products_path, class: "nav-link disabled" %>
            </a>
          </li>
          <li class="nav-item active">
            <a class="nav-link">
              <%= link_to 'カート',  consumers_cart_products_path(current_consumer), class: "nav-link disabled" %>
            </a>
          </li>
          <li class="nav-item active">
            <a class="nav-link">
              <%= link_to '注文履歴',  consumers_orders_path(current_consumer), class: "nav-link disabled" %>
            </a>
          </li>
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" id="navbarDropdown" role="button" aria-haspopup="true" aria-expanded="false">
              農園一覧
            </a>
            <div class="dropdown-menu mt-0" aria-labelledby="navbarDropdown">
              <a class="dropdown-item">
                <%= link_to '一覧',consumers_fermers_path, class: "nav-link disabled" %>
              </a>
              <a class="dropdown-item">
                <%= link_to '記事一覧',consumers_columns_path, class: "nav-link disabled" %>
              </a>
              <a class="dropdown-item">
                <%= link_to 'お気に入り農園一覧',consumers_fermers_path(current_consumer), class: "nav-link disabled" %>
              </a>
              <a class="dropdown-item">
                <%= link_to 'お気に入り記事一覧',consumers_columns_path(current_consumer), class: "nav-link disabled" %>
              </a>
            </div>
          </li>
          <li class="nav-item active">
            <a class="nav-link">
              <%= link_to 'ログアウト', destroy_consumer_session_path, method: :delete,class: "nav-link disabled" %>
            </a>
          </li>
        </ul>
        <div class="search-form">
            <%= form_tag(consumers_search_path,method: :get) do %>
            <%= text_field_tag'search[content]' %>
            <%= select_tag 'search[model]',options_for_select({"農園" => "fermer","記事" => "column"}) %>
              <%= select_tag 'search[how]',options_for_select({ "完全一致" => "match", "前方一致" => "forward", "後方一致" => "backward", "部分一致" => "partical"}) %>
              <%= submit_tag '検索',class: "btn btn-outline-success my-2 my-sm-0" %>
            <% end %>
        </div>
      </div>
    </nav>
    <% else %>
    <nav class="navbar navbar-expand-lg navbar-light bg-light"style="background-color: #99FF66;margin-left: 50px;">
      <a class="navbar-brand" href="#">WAGURI</a>
      <a class="logo"></a>
      <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#Navber" aria-controls="Navber" aria-expanded="false" aria-label="ナビゲーションの切替">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="Navber">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item active">
          <a class="nav-link">
            <%= link_to '商品一覧',consumers_products_path, class: "nav-link disabled" %>
          </a>
        </li>
        <li class="nav-item active">
          <a class="nav-link">
            <%= link_to '新規登録', new_consumer_registration_path, class: "nav-link disabled" %>
          </a>
        </li>
        <li class="nav-item active">
          <a class="nav-link">
            <%= link_to 'ログイン', new_consumer_session_path, class: "nav-link disabled" %>
          </a>
        </li>
      </ul>
    </div>
  </nav>
    <% end %>
  </div>
  <button type="button" class="drawer-toggle drawer-hamburger">
      <span class="sr-only">toggle navigation</span>
      <span class="drawer-hamburger-icon"></span>
    </button>
    <nav class="drawer-nav" role="navigation">
      <div class="search-form"style="margin-top: 100px; margin-left: 30px;">
        <h3>商品検索</h3>
        <%= form_tag(consumers_search_path,method: :get) do %>
        <%= text_field_tag'search[content]' %>
        <%= select_tag 'search[model]',options_for_select({"カテゴリー" => "category","ブランド" => "brand","商品" => "product"}) %>
          <%= select_tag 'search[how]',options_for_select({ "完全一致" => "match", "前方一致" => "forward", "後方一致" => "backward", "部分一致" => "partical"}) %>
          <%= submit_tag '検索',class: "btn btn-outline-success my-2 my-sm-0" %>
        <% end %>
      </div>
      <ul class="drawer-menu">
        <% @brands.each do |brand| %>
          <li><a class="drawer-brand">カテゴリー</a></li>
            <li><a class="drawer-menu-item"><%= brand.category.name%></a></li>
          <li><a class="drawer-brand">ブランド</a></li>
            <li><a class="drawer-menu-item"><%= brand.name%></a></li>
        <% end %>
      </ul>
    </nav>
</header>
<script>
 $(document).ready(function() {
   $('.drawer').drawer();
 });
</script>
<div class="container-fruid">
  <div class="row">
    <div class="col-md-2">
      <h2>オススメ商品</h2>
      <%if @products.present? %>
        <% @products.each do |product| %>
          <%= link_to(consumers_product_path(product)) do %>
            <% if product.product_images.present? %>
               <%= attachment_image_tag product.product_images.first, :image, :fill, 200, 200 %>
            <% else %>
              <%= image_tag 'no_image.jpg',size: '200*200'%>
            <% end %>
          <% end %>
          <%= product.name %>
        <% end %>
      <% end %>
    </div>
    <div class="col-md-8">
      <% content_for :content do %>
      <%= yield %>
      <% end %>
    </div>
    <div class="col-md-2">
      <h2>オススメ記事</h2>
        <%if @columns.present? %>
          <% @columns.each do |column| %>
            <%= link_to(consumers_column_path(column)) do %>
              <% if column.column_images.present? %>
                 <%= attachment_image_tag column.column_images.first, :image, :fill, 200, 200 %>
              <% else %>
                <%= image_tag 'no_image.jpg',size: '400*400'%>
              <% end %>
            <% end %>
            <%= column.title %>
            <%= column.column_favorites.count %>
          <% end %>
        <% end %>
    </div>
      <%= render template: "layouts/application" %>
</div>
</body>
</html>